<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="Description" content="_your description goes here_" />
<meta name="Keywords" content="_your,keywords,goes,here_" />
<meta name="author" content="Codehaus  / Original design: Andreas Viklund - http://andreasviklund.com/" />
<link rel="stylesheet" type="text/css" href="http://media.codehaus.org/themes/standard-green-experimental/andreas03.css" />
<title>PicoContainer - Propagating Dependency</title>
</head>
<body>
<div id="thetop"> 
  <p class="hide">Skip to: <a href="#sitemenu" accesskey="2">Site menu</a> | <a href="#maincontent" accesskey="3">Main content</a></p>
</div>
<div id="container">
  <div id="main">
    <div class="clear"></div>
    <script type="text/javascript"><!--
google_ad_client = "pub-3023399591478482";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel = "7321085054"; //unity-top
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "2266cc";
google_color_url = "2266cc";
google_color_text = "000000";
//--></script>
    <script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
    <div class="content" style="padding-top: 3mm;">
      <div class="section_2">
        <h2><a name="PropagatingDependency-Symptoms" id="PropagatingDependency-Symptoms"></a>Symptoms</h2>
        <p>A dependency exists solely to be propagated to another class, but no methods are called upon the dependent object itself. For example:</p>
        <div class="code">
          <div class="codeContent">
            <pre class="code-java"><span class="code-keyword">public</span> class AControllerImpl <span class="code-keyword">implements</span> AController {

    <span class="code-keyword">private</span> SomeService service;
    <span class="code-keyword">private</span> <span class="code-object">int</span> someId;

    <span class="code-keyword">public</span> AControllerImpl(SomeService service) {
        <span class="code-keyword">this</span>.service = service;
        <span class="code-keyword">this</span>.someId = generateRandomNumber();
    }

    <span class="code-keyword">public</span> launchAnotherController() {
        AnotherController anotherController = <span class="code-keyword">new</span> AnotherControllerImpl(service, fooId);
        anotherController.launch();
    }

    <span class="code-comment">// ...
</span>}</pre>
          </div>
        </div>
        <p>In this example, no method-calls are made upon 'service', it is simply propagated to the constructor of 'AnotherControllerImpl'. Therefore, it is not a valid dependency for 'AControllerImpl'. </p>
      </div>
      <div class="section_2">
        <h2><a name="PropagatingDependency-Causes" id="PropagatingDependency-Causes"></a>Causes</h2>
        <p>DependencyInjection has been partially applied to a hierarchy of classes. This could be because some classes in the hierarchy depend upon instance state not available at container-registration time.</p>
      </div>
      <div class="section_2">
        <h2><a name="PropagatingDependency-WhatToDo" id="PropagatingDependency-WhatToDo"></a>What To Do</h2>
        <p>Apply DependencyInjection to 'AControllerImpl' by replacing the dependency on 'SomeService' with a dependency on 'AnotherController'. If, as in the example above, 'AnotherControllerImpl' has a dependency upon some state that is not available at container-registration time, then we need to introduce a factory for creating 'AnotherController' as follows:</p>
        <p>TODO: This is maybe a little contrieved for this example. Maybe remove or simplify. (AH).</p>
        <div class="code">
          <div class="codeContent">
            <pre class="code-java"><span class="code-keyword">public</span> class AControllerImpl <span class="code-keyword">implements</span> AController {

    <span class="code-keyword">private</span> AnotherControllerFactory anotherControllerFactory;
    <span class="code-keyword">private</span> <span class="code-object">int</span> someId;

    <span class="code-keyword">public</span> AControllerImpl(AnotherControllerFactory anotherControllerFactory) {
        <span class="code-keyword">this</span>.anotherControllerFactory = anotherControllerFactory;
        <span class="code-keyword">this</span>.someId = generateRandomNumber();
    }

    <span class="code-keyword">public</span> launchAnotherController() {
        AnotherController anotherController = anotherControllerFactory.createAnotherController(someId);
        anotherController.launch();
    }

    <span class="code-comment">// ...
</span>}</pre>
          </div>
        </div>
        <p>'AnotherControllerFactory' is an interface:</p>
        <div class="code">
          <div class="codeContent">
            <pre class="code-java"><span class="code-keyword">public</span> <span class="code-keyword">interface</span> AnotherControllerFactory {
    AnotherController createAnotherController(<span class="code-object">int</span> someId);
}</pre>
          </div>
        </div>
        <p>It can be implemented as follows::</p>
        <div class="code">
          <div class="codeContent">
            <pre class="code-java"><span class="code-keyword">public</span> class AnotherControllerFactoryImpl <span class="code-keyword">implements</span> AnotherControllerFactory {
    <span class="code-keyword">private</span> SomeService service;

    <span class="code-keyword">public</span> AnotherControllerFactoryImpl(SomeService service) {
        <span class="code-keyword">this</span>.service = service;
    }

    <span class="code-keyword">public</span> AnotherController createAnotherController(<span class="code-object">int</span> someId) {
        <span class="code-keyword">return</span> <span class="code-keyword">new</span> AnotherControllerImpl(service, someId);
    }
}</pre>
          </div>
        </div>
        <p>Now we can register both 'AControllerImpl' and 'AnotherControllerFactoryImpl' in the container. When 'AControllerImpl' is instantiated, it is supplied with an implementation of 'AnotherControlFactory' that it can use to create an 'AnotherController' instance.</p>
        <div class="section_1">
          <h1><a name="PropagatingDependency-Exceptions" id="PropagatingDependency-Exceptions"></a>Exceptions</h1>
          <p>When <span class="error">[Migrating from executors to services]</span>, it can sometimes be difficult to avoid introducing a Propagating Dependency. In these cases, the Propogating Dependency can be considered as a good first step towards PicoFication of a set of classes. An effort should be made to complete PicoFication at some stage by making a series of further steps as described above.</p>
        </div>
      </div>
    </div>
    <div style="text-align: center; width: 100%; padding-top: 1cm;padding-bottom: 1cm">
      <script type="text/javascript"><!--
google_ad_client = "pub-3023399591478482";
google_ad_width = 300;
google_ad_height = 250;
google_ad_format = "300x250_as";
google_ad_channel ="9744516269"; //unity-bottom
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "009900";
google_color_url = "009900";
google_color_text = "000000";
//--></script>
      <script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
    </div>
  </div>
  <div class="clear">&nbsp;</div>
</div>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-150515-1";
urchinTracker();
</script>
</body>
</html>
