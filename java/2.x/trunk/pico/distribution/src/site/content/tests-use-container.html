<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="Description" content="_your description goes here_" />
<meta name="Keywords" content="_your,keywords,goes,here_" />
<meta name="author" content="Codehaus  / Original design: Andreas Viklund - http://andreasviklund.com/" />
<link rel="stylesheet" type="text/css" href="http://media.codehaus.org/themes/standard-green-experimental/andreas03.css" />
<title>PicoContainer - Container Instantiation</title>
</head>
<body>
<div id="thetop"> 
  <p class="hide">Skip to: <a href="#sitemenu" accesskey="2">Site menu</a> | <a href="#maincontent" accesskey="3">Main content</a></p>
</div>
<div id="container">
  <div id="main">
    <div class="clear"></div>
    <script type="text/javascript"><!--
google_ad_client = "pub-3023399591478482";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel = "7321085054"; //unity-top
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "2266cc";
google_color_url = "2266cc";
google_color_text = "000000";
//--></script>
    <script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
    <div class="content" style="padding-top: 3mm;">
      <div class="section_2">
        <h2><a name="ContainerInstantiation-Symptoms" id="ContainerInstantiation-Symptoms"></a>Symptoms</h2>
        <p> A class is directly instantiating a PicoContainer and registering components within it. </p>
      </div>
      <div class="section_2">
        <h2><a name="ContainerInstantiation-Causes" id="ContainerInstantiation-Causes"></a>Causes</h2>
        <p>This smell is most often found in unit tests. It could be as a result of <a href="/Container+Dependency" title="Container Dependency">Container Dependency</a>. The container is supplied to the class being tested, which then uses it to locate its dependencies.</p>
        <p>Another cause is using the container to build the object we are testing, which itself may have several dependencies. For example::</p>
        <div class="code">
          <div class="codeContent">
            <pre class="code-java"><span class="code-keyword">public</span> void testCocktailWithVodkaIsAlcoholic() {
    DefaultPicoContainer container = <span class="code-keyword">new</span> DefaultPicoContainer();
    container.registerComponentImplementation(Banana.class);
    container.registerComponentImplementation(Vanilla.class);
    container.registerComponentImplementation(Vodka.class);
    container.registerComponentImplementation(Cocktail.class);

    Cocktail cocktail = (Cocktail) container.getComponentInstance(Cocktail.class);

    assertTrue(cocktail.isAlcoholic());
}</pre>
          </div>
        </div>
      </div>
      <div class="section_2">
        <h2><a name="ContainerInstantiation-WhatToDo" id="ContainerInstantiation-WhatToDo"></a>What To Do</h2>
        <p>For unit tests like this, the class being tested should be instantiated directly by the test. <a href="/Mock+Objects" title="Mock Objects">Mock Objects</a> should be used to &quot;mock&quot; the dependent objects, i.e. supplying a fake implementation that can have expectations set and verified on it, rather than a real implementataion. So, the test becomes:</p>
        <div class="code">
          <div class="codeContent">
            <pre class="code-java"><span class="code-keyword">public</span> void testCocktailWithVodkaIsAlcoholic() {

    Banana banana = createMockBanana();
    Vanilla vanilla = createMockVanilla();
    Vodka vodka = createMockVodka();

    <span class="code-comment">// set expectations on banana, vanilla and vodka here.
</span>
    Cocktail cocktail = <span class="code-keyword">new</span> Cocktail(banana, vanilla, vodka);
    assertTrue(cocktail.isAlcoholic());

    <span class="code-comment">// verify expectations on banana, vanilla and vodka here.
</span>}</pre>
          </div>
        </div>
        <p>The implementation details of creating a mock object and setting and verifying expectations have been left out of the example, as the details depend on which mock object library/technique is used.</p>
      </div>
      <div class="section_2">
        <h2><a name="ContainerInstantiation-Exceptions" id="ContainerInstantiation-Exceptions"></a>Exceptions</h2>
        <p>The container has to be instantiated somewhere!</p>
        <div class="section_3">
          <h3><a name="ContainerInstantiation-Bootstrappers" id="ContainerInstantiation-Bootstrappers"></a>Bootstrappers</h3>
          <p>A common place to instantiate containers is in some bootstrap class in the application.</p>
          <div class="section_1">
            <h1><a name="ContainerInstantiation-FunctionalTests" id="ContainerInstantiation-FunctionalTests"></a>Functional Tests</h1>
            <p>There may be a requirement to write a high-level &quot;functional&quot; test, in which you wish to test the interactions between a set of real components (not mocks). In this case, you may wish to create a container with the appropriate components registered for your test.</p>
            <div class="section_3">
              <h3><a name="ContainerInstantiation-NanoContainer" id="ContainerInstantiation-NanoContainer"></a>NanoContainer</h3>
              <p>If you are using <a href="/Sister+Projects" title="Sister Projects">NanoContainer</a>, you can use NanoContainer's Standalone class (a bootstrapper) to start the application. All the container configuration can live in a script and NanoContainer (and thereby PicoContainer(s)) will be instantiated.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div style="text-align: center; width: 100%; padding-top: 1cm;padding-bottom: 1cm">
      <script type="text/javascript"><!--
google_ad_client = "pub-3023399591478482";
google_ad_width = 300;
google_ad_height = 250;
google_ad_format = "300x250_as";
google_ad_channel ="9744516269"; //unity-bottom
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "009900";
google_color_url = "009900";
google_color_text = "000000";
//--></script>
      <script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
    </div>
  </div>
  <div class="clear">&nbsp;</div>
</div>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-150515-1";
urchinTracker();
</script>
</body>
</html>
