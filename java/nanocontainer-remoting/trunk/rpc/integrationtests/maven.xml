<project default="test:test" xmlns:maven="jelly:maven" xmlns:j="jelly:core" xmlns:util="jelly:util" xmlns:ant="jelly:ant">

	<property file="..\project.properties"/>

	<postGoal name="test:compile">
		
		 
		 <!-- /**Generate proxies for test cases */ -->
		 <ant:taskdef name="nanocontainer-remoting-proxies" classname="org.nanocontainer.remoting.tools.generator.ant.ProxyGenerationTask">
			<ant:classpath>
				<ant:path refid="maven.dependency.classpath"/>
			</ant:classpath>
		</ant:taskdef>

		<ant:mkdir dir="${maven.build.dir}/genjava"/>
		<ant:nanocontainer-remoting-proxies genname="Hello" srcgendir="${maven.build.dir}/genjava"
							classgendir="${maven.build.dir}/test-classes" verbose="true"
							interfaces="org.nanocontainer.remoting.test.TestInterface"
							additionalfacades="org.nanocontainer.remoting.test.TestInterface3,org.nanocontainer.remoting.test.TestInterface2"
							callbackfacades="org.nanocontainer.remoting.test.TestCallBackListener">
			<ant:classpath>
				<ant:path refid="maven.dependency.classpath"/>
				<ant:pathelement location="${maven.build.dir}/test-classes"/>
			</ant:classpath>
		</ant:nanocontainer-remoting-proxies>

		<ant:nanocontainer-remoting-proxies genname="OurAccountManager" srcgendir="${maven.build.dir}/genjava"
			classgendir="${maven.build.dir}/test-classes" verbose="true" 
			interfaces="org.nanocontainer.remoting.test.clientcontext.AccountManager">
		  <ant:classpath>
				<ant:path refid="maven.dependency.classpath"/>
                <ant:pathelement location="${maven.build.dir}/test-classes"/>
		  </ant:classpath>
		</ant:nanocontainer-remoting-proxies>

        <ant:taskdef resource="org/apache/commons/attributes/anttasks.properties"/>

		<!-- TODO: Remove hardcoded test src dir (vinay) -->
		<ant:attribute-compiler destDir="${maven.build.dir}/test-classes">
			<ant:fileset dir="${maven.src.dir}/test/" includes="*.java"/>
		</ant:attribute-compiler>



	</postGoal>

</project>
