<project default="jar:install"
    xmlns:j="jelly:core">


    <preGoal name="xdoc:jelly-transform">
        <attainGoal name="html2xdoc"/>
    </preGoal>

    <goal name="cvs:make-patch" description="Creates a patch of *your* changes">
        <cvs command="-q diff -b -u -N" output="patch.txt"/>
        <echo>
            Please create a new issue in PicoContainer's JIRA:
            http://jira.codehaus.org/secure/BrowseProject.jspa?id=10120
            Then attach the patch.txt file.
            If your patch consists of entirely new files too, please zip them
            up and attach them too.

            If your patch includes JUnit tests and a decent description,
            you increase the chance of having the patch applied by some
            of the committers.
        </echo>
    </goal>

    <postGoal name="dist:prepare-bin-filesystem">
        <attainGoal name="pico:tck-jar" />
        <copy file="${maven.build.dir}/${pom.artifactId}-tck-${pom.currentVersion}.jar"
            todir="${maven.dist.bin.assembly.dir}" />
    </postGoal>

    <goal name="pico:tck-jar">
        <jar jarfile="${maven.build.dir}/${pom.artifactId}-tck-${pom.currentVersion}.jar">
            <fileset dir="${pom.getPluginContext('maven-test-plugin').getVariable('maven.test.dest')}" />
        </jar>
    </goal>

    <postGoal name="jar:install">
        <attainGoal name="pico:tck-jar" />
        <property name="jardir__" value="${maven.repo.local}/${pom.artifactDirectory}/jars"/>
        <mkdir dir="${jardir__}"/>    
        <copy 
            file="${maven.build.dir}/${pom.artifactId}-tck-${pom.currentVersion}.jar"
            todir="${jardir__}"
            overwrite="true"
        />
    </postGoal>

</project>
