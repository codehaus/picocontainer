<project default="binary:install"
    xmlns:j="jelly:core">

    <goal name="binary:install" prereqs="jar:install"/>
    <goal name="binary:deploy">
         <attainGoal name="jar:deploy"/>
         <attainGoal name="site:deploy"/>
         
         <j:if test="${!pom.currentVersion.endsWith('SNAPSHOT')}">
           <!-- IT IS A RELEASE -->
           <attainGoal name="dist:deploy"/>
         </j:if>
    </goal>

    <goal name="pico:tck-jar">
        <jar jarfile="${maven.build.dir}/${pom.artifactId}-tck-${pom.currentVersion}.jar">
            <fileset dir="${pom.getPluginContext('maven-test-plugin').getVariable('maven.test.dest')}" />
        </jar>
    </goal>

    <postGoal name="jar:install">
        <attainGoal name="pico:tck-jar" />
        <property name="jardir__" value="${maven.repo.local}/${pom.artifactDirectory}/jars"/>
        <mkdir dir="${jardir__}"/>
        <copy
            file="${maven.build.dir}/${pom.artifactId}-tck-${pom.currentVersion}.jar"
            todir="${jardir__}"
            overwrite="true"
        />
    </postGoal>

</project>
